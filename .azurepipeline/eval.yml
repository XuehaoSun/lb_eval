trigger:
  branches:
    include:
      - main
  paths:
    include:
      - .azure-pipelines
      - "**/*.json"
    exclude:
      - evaluation

pool: "ubuntu-latest"

stages:
  - stage: CheckHardware
    jobs:
      - job: CheckHardware
        steps:
        - bash: |
            echo "##vso[task.setvariable variable=hardware;]$(jq .hardware eval.json)"
            echo "##vso[task.setvariable variable=scripts;]$(jq .scripts eval.json)"
          name: setVarFromJsonFileValue

  - stage: Eval
    displayName: Evaluation
    pool: $(hardware)
    dependsOn: [CheckHardware]
    jobs:
      - job: Eval
        steps:
          - template: template/model-template.yml
            parameters:
              scriptsPath: "$(scripts)"
